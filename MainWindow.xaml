<Window x:Class="PomodoroTimer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ctrl="clr-namespace:PomodoroTimer.Controls"
        Title="Pomodoro Timer"
        Width="580"
        Height="580"
        MinHeight="650"
        Background="{StaticResource BackgroundBrush}"
        Foreground="{StaticResource TextBrush}"
        WindowStartupLocation="CenterScreen"
        PreviewKeyDown="Window_PreviewKeyDown">
    <Window.Resources>
        <Style x:Key="ControlIconButtonStyle"
               TargetType="Button"
               BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Width" Value="64"/>
            <Setter Property="Height" Value="64"/>
            <Setter Property="Padding" Value="0"/>
        </Style>

        <Geometry x:Key="ChangeIconGeometry">
            M480,880Q337,880 227,790Q117,700 88,560L170,560Q198,666 284,733Q370,800 480,800Q566,800 640,757.5Q714,715 756,640L640,640L640,560L880,560L880,800L800,800L800,720Q743,796 659,838Q575,880 480,880ZM480,600Q430,600 395,565Q360,530 360,480Q360,430 395,395Q430,360 480,360Q530,360 565,395Q600,430 600,480Q600,530 565,565Q530,600 480,600ZM80,400L80,160L160,160L160,240Q217,164 301,122Q385,80 480,80Q623,80 733,170Q843,260 872,400L790,400Q762,294 676,227Q590,160 480,160Q394,160 320,202.5Q246,245 204,320L320,320L320,400L80,400Z
        </Geometry>
        <Geometry x:Key="PlayPauseIconGeometry">
            M200,648L200,312L440,480L200,648ZM520,640L520,320L600,320L600,640L520,640ZM680,640L680,320L760,320L760,640L680,640Z
        </Geometry>
        <Geometry x:Key="StopCircleIconGeometry">
            M320,640L640,640L640,320L320,320L320,640ZM480,880Q397,880 324,848.5Q251,817 197,763Q143,709 111.5,636Q80,563 80,480Q80,397 111.5,324Q143,251 197,197Q251,143 324,111.5Q397,80 480,80Q563,80 636,111.5Q709,143 763,197Q817,251 848.5,324Q880,397 880,480Q880,563 848.5,636Q817,709 763,763Q709,817 636,848.5Q563,880 480,880ZM480,800Q614,800 707,707Q800,614 800,480Q800,346 707,253Q614,160 480,160Q346,160 253,253Q160,346 160,480Q160,614 253,707Q346,800 480,800ZM480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Q480,480 480,480Z
        </Geometry>
    </Window.Resources>
    <Grid Background="{StaticResource BackgroundBrush}" Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ВРЕМЯ + СТАТУС -->
        <StackPanel Grid.Row="0" Margin="0,0,0,12">
            <TextBlock x:Name="TimeText"
                       Text="00:00"
                       FontSize="44"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       Margin="0,4,0,0"/>
            <TextBlock x:Name="StatusText"
                       Text="Готов"
                       HorizontalAlignment="Center"
                       Margin="0,4,0,0"
                       Foreground="{StaticResource SubtleTextBrush}"/>
        </StackPanel>

        <!-- КНОПКИ УПРАВЛЕНИЯ -->
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,8">
            <Button Style="{StaticResource ControlIconButtonStyle}"
                    Click="Change_Click"
                    ToolTipService.InitialShowDelay="2000"
                    AutomationProperties.Name="Сменить режим">
                <Button.ToolTip>
                    <ToolTip Content="Горячая клавиша: Ctrl+Alt+A"/>
                </Button.ToolTip>
                <Viewbox Width="32" Height="32">
                    <Path Data="{StaticResource ChangeIconGeometry}"
                          Fill="{StaticResource TextBrush}"/>
                </Viewbox>
            </Button>
            <Button x:Name="StartPauseButton"
                    Style="{StaticResource ControlIconButtonStyle}"
                    Click="StartPause_Click"
                    ToolTipService.InitialShowDelay="2000"
                    AutomationProperties.Name="Запустить или поставить на паузу таймер">
                <Button.ToolTip>
                    <ToolTip Content="Старт/пауза: Ctrl+Alt+D"/>
                </Button.ToolTip>
                <Viewbox Width="32" Height="32">
                    <Path Data="{StaticResource PlayPauseIconGeometry}"
                          Fill="{StaticResource TextBrush}"/>
                </Viewbox>
            </Button>
            <Button Style="{StaticResource ControlIconButtonStyle}"
                    Click="Stop_Click"
                    ToolTipService.InitialShowDelay="2000"
                    AutomationProperties.Name="Остановить таймер">
                <Button.ToolTip>
                    <ToolTip Content="Стоп и сброс в 00:00: Ctrl+Alt+S"/>
                </Button.ToolTip>
                <Viewbox Width="32" Height="32">
                    <Path Data="{StaticResource StopCircleIconGeometry}"
                          Fill="{StaticResource TextBrush}"/>
                </Viewbox>
            </Button>
        </StackPanel>

        <!-- АВТОПРОДОЛЖЕНИЕ -->
        <CheckBox x:Name="AutoContinueCheck"
                  Grid.Row="2"
                  Content="Auto-continue next period"
                  Margin="4,0,0,10"/>

        <!-- ПРЕСЕТЫ + ГИСТОГРАММА -->
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Presets -->
            <GroupBox Header="Presets" Grid.Row="0" Margin="0,0,0,10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <ListBox x:Name="PresetList"
                             Grid.Row="0"
                             Margin="0,0,0,8"
                             DisplayMemberPath="Name"
                             SelectionChanged="PresetList_SelectionChanged"/>

                    <StackPanel Grid.Row="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Center">
                        <Button Content="Add" Width="70" Click="AddPreset_Click"/>
                        <Button Content="Edit" Width="70" Click="EditPreset_Click"/>
                        <Button Content="Delete" Width="70" Click="DeletePreset_Click"/>
                    </StackPanel>
                </Grid>
            </GroupBox>

            <!-- Chart -->
            <GroupBox Header="История помидоро (гистограмма)"
                      Grid.Row="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0">
                        <Button Content="Окно статистики"
                                HorizontalAlignment="Right"
                                Click="OpenStatsWindow_Click"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal"
                                Grid.Row="1"
                                HorizontalAlignment="Center"
                                Margin="0,4,0,6">
                        <TextBlock Text="День:"
                                   Margin="0,0,6,0"/>
                        <TextBlock x:Name="HistoryDateText"
                                   Text="—"
                                   FontWeight="Bold"/>
                        <TextBlock Text="(← предыдущий, → следующий)"
                                   Margin="8,0,0,0"
                                   Foreground="{StaticResource SubtleTextBrush}"/>
                    </StackPanel>

                    <ctrl:DailyChartControl x:Name="DailyChart"
                                            Grid.Row="2"
                                            MinHeight="140"
                                            Margin="0"/>
                </Grid>
            </GroupBox>
        </Grid>
    </Grid>
</Window>
